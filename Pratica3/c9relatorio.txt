Apenas era necessario colocar um free dentro da função